/*******************************************************************************

    Author ......... Arno Streuli
    Contact ........ astreuli@gmail.com
    Home Site ...... http://cactiusers.org
    Program ........ Network Link Discovery for Cacti
    Purpose ........ Network Link Discovery

*******************************************************************************/

----[ Purpose

	This plugin is for scanning the network and follow the CDP discovered host, creating graph of all uplink.

----[ Installation

	To install the plugin, please refer to the Plugin Installation Documentation

	linkdiscovery requires the Settings plugin to be installed at least, but ideally thold and monitor too
    
----[ Possible Bugs?
   
    The way you can call thold from another plugin: it create a threshold based on all your template, as long as it fit your interface. Example: if you have a traffic threshold and a status threshold, both will be created !
	It's a simple way of doing it, and not very good. I'm planning to create better way, but that require to write directly into cacti database, without calling thold plugin
	
	On slow link it can crash you poller process, so I advice to disable slow link device
	If you find a problem, let me know!!! http://bugs.cacti.net

----[ Future Changes

	Got any ideas or complaints, please e-mail me!

----[ Changelog

0.2	Added the Switch/router equipement type into the comment
0.3 Added a search based on destination hostname on the discover page
0.4 Addeds option for LLDP support
1.0 SCacti 1.x Compliant
1.0.2 added optional graph for non unicast packet
1.0.3 added the option to keep trace of IP phone, and keep the phone number. And keep WiFi AP monitored with ping
1.1.0 if extenddb is present we keep serial_no and type into the extention of the DB
1.1.1 added the management of the flag isPhone if extenddb is present
1.2.0 use automation templates to define what Device template has to be applied, and in the setting -> linkdiscovery just enable or disable graph creation
1.2.1 integration to EfficientIP netchange device management
1.2.2 make some cleaning about old configuration, and correct some graph creation problem
1.2.3 Don't graph subinterface, only type ethernetcsmacd (type 6) and tunnel(131)
1.2.4 Add the option to add to Aruba Clearpass NAC, as every discovered device will be added to the server provided
1.2.5 In Settings Linkdiscovery Seed device is displayed with description instead of hostname
1.2.6 Some optimisation on findhost, include detection if the process is allready running, and proxy bypass on parse-url, improve serial number reading fom switch based on type